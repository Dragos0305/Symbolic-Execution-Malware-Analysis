import angr
from pypattyrn.creational.singleton import Singleton
from Binary import Binary

"""

    Singleton type class used for setup analysis context of target file

"""

class AnalysisContext(object, metaclass=Singleton):

    path_to_filename: str
    project: angr.Project
    simulation_manager: angr.SimulationManager
    binary_file: Binary
    
    def __init__(self, path_to_filename: str) -> None:
        
        self.path_to_filename = path_to_filename
        self.project = angr.Project(path_to_filename)
        self.simulation_manager = self.project.factory.simgr
        self.binary_file = Binary(self.project)

